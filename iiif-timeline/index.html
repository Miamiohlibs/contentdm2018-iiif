<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>CONTENTdm IIIF Timeline</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link title="timeline-styles" rel="stylesheet" href="https://cdn.knightlab.com/libs/timeline3/latest/css/timeline.css">
</head>

<body>
    <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="#">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <script src="https://cdn.knightlab.com/libs/timeline3/latest/js/timeline.js"></script>
    <div id='timeline-embed' style="width: 100%; height: 600px"></div>

    <script src="axios.min.js"></script>
    <script src="iiif-tools.js"></script>
    <script>
        let timeline_json = {};
        let iiif_manifest = {};
        // Get a manifest
        axios.get('http://images.indianahistory.org/digital/iiif-info/dc048/4')
            .then(function (response) {
                iiif_manifest = response.data;
                let imageUrl = iiif_manifest.sequences[0].canvases[0].images[0].resource['@id'];
                // Create a patch for IIIF Manifest -> TimelineJS
                timeline_json = {
                    "title": {
                        "text": {
                            "headline": "CONTENTdm IIIF Timeline"
                        }
                    },
                    "events": [
                        {
                            "media": {
                                "url": updateIIIFImageUrl(imageUrl, 'size', '600,'),
                                "credit": iiif_manifest.attribution['@value'],
                                "thumbnail": updateIIIFImageUrl(imageUrl, 'size', '100,')
                            },
                            "start_date": {
                                "year": "1880"
                            },
                            "text": {
                                "headline": iiif_manifest.metadata[0].value
                            }
                        }
                    ]
                }
                // Populate the timeline
                window.timeline = new TL.Timeline('timeline-embed', timeline_json);

            })
            .catch(function (error) {
                console.log(error);
            });
    </script>

</body>

</html>